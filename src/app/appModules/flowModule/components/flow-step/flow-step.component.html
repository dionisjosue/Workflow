<div class="row">
    <div class="pagetitle">
      <div class="col-2">
        <h2 (click)="toggle()">ETAPAS
          <a  class="btn btn-sm btn-link"><i class="fa-solid " [ngClass]="{'fa-chevron-up':istoggle,'fa-chevron-down':!istoggle}"></i></a>
        </h2>
      </div>
      <br/>
    </div>

    <form [formGroup]="formFlow">
      <div formArrayName="rows">
        <div class="row fade-in-out" [ngClass]="{'show': istoggle}" *ngFor="let row of rows.controls; let i = index" [formGroupName]="i">


          <div class="mb-4 col-3 form-group">
            <label class="form-label">Nombre Etapa en el Flujo</label>
            <div>
              <input formControlName="referenceName" class="form-control form-control-sm" type="text">
            </div>
          </div>

          <div class="mb-4 col-3 form-group">
            <label class="form-label">Etapa</label>

            <div>
                <ng-select  formControlName="stepFk"
                [items]="steps" [selectOnTab]="true" 
                    bindLabel="name" 
                    bindValue="id" >
                </ng-select>
                
                

            </div>
                    
          </div>
          <div class="mb-4 col-3 form-group">
              <label class="form-label">Proxima Paso (Default)</label>
              <div>
                <ng-select formControlName="NextFlowIdx" 
                [items]="flowSteps" [selectOnTab]="true" 
                    bindLabel="referenceName" 
                    bindValue="idx" (focus)="setItems()">
                </ng-select>
              </div>
          </div>
          <input type="hidden" formControlName="idx"/>
          <input type="hidden" formControlName="id"/>


          <div class="col-md-2 offset-1" style="top: 30%; position: relative;">
            <a (click)="createRow(null)" style="margin-right: 8px;" class="btn btn-success btn-sm"><i class="fa-solid fa-plus"></i></a>
            <a *ngIf="this.rows.length > 1" (click)="removeRow(i)" class="btn btn-sm btn-danger">
              <i class="fa-solid fa-trash-can"></i>
            </a>
            <a class="btn btn-secondary btn-sm" style="margin-top: 8px;">
              <i class="fa-solid fa-plus" style="margin-right: 3px;"></i>CONDICIONALES
            </a>
          </div>

      
          <div class="mb-4 col-9 form-group">
            <label class="form-label">Comentarios</label>
            <input formControlName="comments" class="form-control form-control-sm"/>
          </div>
          <hr>
      </div>
    </div>
  </form>
</div>